-- This script was generated by a beta version of the ERD tool in pgAdmin 4.
-- Please log an issue at https://redmine.postgresql.org/projects/pgadmin4/issues/new if you find any bugs, including reproduction steps.
BEGIN;


CREATE TABLE public.additionals
(
    additional_id integer NOT NULL,
    additional_daily_price double precision NOT NULL,
    additional_name character varying(255) NOT NULL,
    max_units_per_rental smallint NOT NULL,
    PRIMARY KEY (additional_id)
);

CREATE TABLE public.brands
(
    brand_id integer NOT NULL,
    brand_name character varying(255) NOT NULL,
    PRIMARY KEY (brand_id)
);

CREATE TABLE public.car_crashes
(
    car_crash_id integer NOT NULL,
    crash_date date NOT NULL,
    crash_valuation double precision NOT NULL,
    car_id integer NOT NULL,
    PRIMARY KEY (car_crash_id)
);

CREATE TABLE public.car_maintenances
(
    maintenance_id integer NOT NULL,
    description character varying(255) NOT NULL,
    return_date date,
    car_id integer NOT NULL,
    PRIMARY KEY (maintenance_id)
);

CREATE TABLE public.cars
(
    car_id integer NOT NULL,
    daily_price double precision NOT NULL,
    description character varying(255),
    kilometer integer NOT NULL,
    model_year integer NOT NULL,
    brand_id integer NOT NULL,
    color_id integer NOT NULL,
    PRIMARY KEY (car_id)
);

CREATE TABLE public.cities
(
    city_id integer NOT NULL,
    city_name character varying(255) NOT NULL,
    PRIMARY KEY (city_id)
);

CREATE TABLE public.colors
(
    color_id integer NOT NULL,
    color_name character varying(255) NOT NULL,
    PRIMARY KEY (color_id)
);

CREATE TABLE public.corporate_customers
(
    company_name character varying(255) NOT NULL,
    corporate_customer_id integer NOT NULL,
    tax_number character varying(10) NOT NULL,
    PRIMARY KEY (corporate_customer_id)
);

CREATE TABLE public.credit_cards
(
    credit_card_id integer NOT NULL,
    card_cvv character varying(3) NOT NULL,
    card_expiration_date character varying(255) NOT NULL,
    card_number character varying(16) NOT NULL,
    card_owner character varying(255) NOT NULL,
    customer_id integer NOT NULL,
    PRIMARY KEY (credit_card_id)
);

CREATE TABLE public.customers
(
    customer_id integer NOT NULL,
    registration_date date,
    PRIMARY KEY (customer_id)
);

CREATE TABLE public.individua_customers
(
    first_name character varying(255) NOT NULL,
    individual_customer_id integer NOT NULL,
    last_name character varying(255) NOT NULL,
    national_identity character varying(11) NOT NULL,
    PRIMARY KEY (individual_customer_id)
);

CREATE TABLE public.invoices
(
    invoice_id integer NOT NULL,
    creation_date date,
    finish_date date NOT NULL,
    invoice_no character varying(16) NOT NULL,
    price_of_additional double precision,
    price_of_days double precision NOT NULL,
    price_of_diff_city double precision,
    rental_car_total_price double precision NOT NULL,
    start_date date NOT NULL,
    total_rental_day smallint NOT NULL,
    customer_id integer NOT NULL,
    payment_id integer NOT NULL,
    rental_car_id integer NOT NULL,
    PRIMARY KEY (invoice_id)
);

CREATE TABLE public.ordered_additionals
(
    ordered_additional_id integer NOT NULL,
    ordered_additional_quantity smallint NOT NULL,
    additional_id integer NOT NULL,
    rental_car_id integer NOT NULL,
    PRIMARY KEY (ordered_additional_id)
);

CREATE TABLE public.payments
(
    payment_id integer NOT NULL,
    total_price double precision NOT NULL,
    rental_car_id integer NOT NULL,
    PRIMARY KEY (payment_id)
);

CREATE TABLE public.rental_cars
(
    rental_car_id integer NOT NULL,
    delivered_kilometer integer,
    finish_date date NOT NULL,
    rented_kilometer integer,
    start_date date NOT NULL,
    car_id integer NOT NULL,
    customer_id integer NOT NULL,
    delivered_city integer NOT NULL,
    rented_city integer NOT NULL,
    PRIMARY KEY (rental_car_id)
);

CREATE TABLE public.users
(
    user_id integer NOT NULL,
    email character varying(255) NOT NULL,
    password character varying(255) NOT NULL,
    PRIMARY KEY (user_id)
);

ALTER TABLE public.car_crashes
    ADD FOREIGN KEY (car_id)
    REFERENCES public.cars (car_id)
    NOT VALID;


ALTER TABLE public.car_maintenances
    ADD FOREIGN KEY (car_id)
    REFERENCES public.cars (car_id)
    NOT VALID;


ALTER TABLE public.cars
    ADD FOREIGN KEY (brand_id)
    REFERENCES public.brands (brand_id)
    NOT VALID;


ALTER TABLE public.cars
    ADD FOREIGN KEY (color_id)
    REFERENCES public.colors (color_id)
    NOT VALID;


ALTER TABLE public.corporate_customers
    ADD FOREIGN KEY (corporate_customer_id)
    REFERENCES public.customers (customer_id)
    NOT VALID;


ALTER TABLE public.credit_cards
    ADD FOREIGN KEY (customer_id)
    REFERENCES public.customers (customer_id)
    NOT VALID;


ALTER TABLE public.customers
    ADD FOREIGN KEY (customer_id)
    REFERENCES public.users (user_id)
    NOT VALID;


ALTER TABLE public.individua_customers
    ADD FOREIGN KEY (individual_customer_id)
    REFERENCES public.customers (customer_id)
    NOT VALID;


ALTER TABLE public.invoices
    ADD FOREIGN KEY (rental_car_id)
    REFERENCES public.rental_cars (rental_car_id)
    NOT VALID;


ALTER TABLE public.invoices
    ADD FOREIGN KEY (customer_id)
    REFERENCES public.customers (customer_id)
    NOT VALID;


ALTER TABLE public.invoices
    ADD FOREIGN KEY (payment_id)
    REFERENCES public.payments (payment_id)
    NOT VALID;


ALTER TABLE public.ordered_additionals
    ADD FOREIGN KEY (additional_id)
    REFERENCES public.additionals (additional_id)
    NOT VALID;


ALTER TABLE public.ordered_additionals
    ADD FOREIGN KEY (rental_car_id)
    REFERENCES public.rental_cars (rental_car_id)
    NOT VALID;


ALTER TABLE public.payments
    ADD FOREIGN KEY (rental_car_id)
    REFERENCES public.rental_cars (rental_car_id)
    NOT VALID;


ALTER TABLE public.rental_cars
    ADD FOREIGN KEY (delivered_city)
    REFERENCES public.cities (city_id)
    NOT VALID;


ALTER TABLE public.rental_cars
    ADD FOREIGN KEY (car_id)
    REFERENCES public.cars (car_id)
    NOT VALID;


ALTER TABLE public.rental_cars
    ADD FOREIGN KEY (rented_city)
    REFERENCES public.cities (city_id)
    NOT VALID;


ALTER TABLE public.rental_cars
    ADD FOREIGN KEY (customer_id)
    REFERENCES public.customers (customer_id)
    NOT VALID;

END;